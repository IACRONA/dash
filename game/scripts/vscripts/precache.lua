local particles = 
{
    "particles/overhead_particle/leader_overhead.vpcf",
    "particles/econ/items/tinker/boots_of_travel/teleport_start_bots_ground_flash.vpcf",
    "particles/econ/events/fall_major_2015/teleport_end_fallmjr_2015_ground_flash.vpcf",
    "particles/units/heroes/hero_invoker/invoker_alacrity.vpcf",
    "particles/units/heroes/hero_invoker/invoker_emp.vpcf",
    "particles/units/heroes/hero_invoker/invoker_ghost_walk.vpcf",
    "particles/units/heroes/hero_invoker/invoker_ghost_walk_debuff.vpcf",
    "particles/units/heroes/hero_invoker/invoker_sun_strike_team.vpcf",
    "particles/units/heroes/hero_invoker/invoker_sun_strike.vpcf",
    "particles/units/heroes/hero_invoker/invoker_cold_snap.vpcf",
    "particles/units/heroes/hero_invoker/invoker_cold_snap_status.vpcf",
    "particles/units/heroes/hero_invoker/invoker_cold_snap.vpcf",
    "particles/units/heroes/hero_invoker/invoker_chaos_meteor_fly.vpcf",
    "particles/units/heroes/hero_invoker/invoker_chaos_meteor.vpcf",
    "particles/units/heroes/hero_invoker/invoker_chaos_meteor_burn_debuff.vpcf",
    "particles/units/heroes/hero_invoker/invoker_tornado.vpcf",
    "particles/units/heroes/hero_invoker/invoker_tornado_child.vpcf",
    "particles/units/heroes/hero_invoker/invoker_deafening_blast.vpcf",
    "particles/units/heroes/hero_invoker/invoker_deafening_blast_knockback_debuff.vpcf",
    "particles/units/heroes/hero_invoker/invoker_deafening_blast_disarm_debuff.vpcf",
    "particles/status_fx/status_effect_iceblast.vpcf",
    "particles/units/heroes/hero_invoker/invoker_ice_wall.vpcf",
    "particles/units/heroes/hero_invoker/invoker_ice_wall_debuff.vpcf",
    "particles/status_fx/status_effect_frost.vpcf",
    "particles/units/heroes/hero_tinker/tinker_rearm.vpcf",
    "particles/econ/items/necrolyte/necro_ti9_immortal/necro_ti9_immortal_ambient",
    "particles/head_flag.vpcf",
    "particles/units/heroes/hero_arc_warden/arc_warden_tempest_cast.vpcf",
    "particles/ui/ui_game_start_hero_spawn.vpcf",
    "particles/units/heroes/hero_legion_commander/legion_commander_duel_victory.vpcf",
    "particles/djalal/custom_timer.vpcf",
    "particles/morph_head_skull.vpcf",
    "particles/units/heroes/hero_lion/lion_spell_finger_of_death.vpcf",
    "particles/units/heroes/hero_invoker/invoker_deafening_blast.vpcf",
    "particles/units/heroes/hero_morphling/morphling_waveform.vpcf",
    "particles/units/heroes/hero_crystalmaiden/maiden_frostbite.vpcf",
    "particles/units/heroes/hero_crystalmaiden/maiden_frostbite_buff.vpcf",
    "particles/units/heroes/hero_crystalmaiden/maiden_crystal_nova.vpcf",
    "particles/units/heroes/hero_skeletonking/wraith_king_reincarnate.vpcf",
    "particles/units/heroes/hero_muerta/muerta_parting_shot_projectile.vpcf",
    "particles/items2_fx/refresher.vpcf",
    "particles/units/heroes/hero_ogre_magi/ogre_magi_multicast.vpcf",
    "particles/units/heroes/hero_techies/techies_blast_off.vpcf",
    "particles/units/heroes/hero_skeletonking/wraith_king_reincarnate.vpcf",
    "particles/acrona/ghost_sword/ghost_sword_projectile_juggernaut.vpcf",
    "particles/units/heroes/hero_antimage/antimage_spellshield_reflect.vpcf",
    "particles/units/heroes/hero_antimage/antimage_spellshield.vpcf",
    "particles/units/heroes/hero_antimage/antimage_spellshield_reflect.vpcf",
    "particles/econ/items/abaddon/abaddon_alliance/abaddon_aphotic_shield_alliance.vpcf",
    "particles/econ/items/abaddon/abaddon_alliance/abaddon_aphotic_shield_alliance_explosion.vpcf",
    "particles/acrona/ghost_sword/ghost_sword_ghosts.vpcf",
    "models/flag/particle/banner_fire_main.vpcf",
    "models/flag/particle/banner2_fire_main.vpcf",
    "particles/units/heroes/hero_sniper/sniper_headshot_slow.vpcf",
    "particles/units/heroes/hero_troll_warlord/troll_warlord_battletrance_buff.vpcf",
    "particles/status_fx/status_effect_snapfire_slow.vpcf",
    "particles/status_fx/status_effect_troll_warlord_battletrance.vpcf",
    "particles/hw_fx/golem_terror_status_effect.vpcf",
    "particles/hw_fx/golem_terror_debuff.vpcf",
    "particles/hw_fx/golem_terror.vpcf",
    "particles/hw_fx/golem_terror_telegraph_guardian.vpcf",
    "particles/hw_fx/golem_terror_debuff.vpcf",
    "particles/units/heroes/hero_legion_commander/legion_commander_duel_victory.vpcf",
    "particles/generic_timer.vpcf",
    "particles/head_flag.vpcf",
    "particles/econ/items/lina/lina_head_headflame/lina_headflame.vpcf",
    "particles/econ/items/lina/lina_head_headflame/lina_flame_hand_dual_headflame.vpcf",
    "particles/djalal/custom_timer.vpcf",
    "particles/econ/items/pets/pet_frondillo/pet_spawn_frondillo.vpcf",
    "particles/immunity_sphere_buff.vpcf",
    "particles/units/heroes/hero_zuus/red_zuus_arc_lightning.vpcf",
    "particles/units/heroes/hero_cursed_k/cursed_shield_green.vpcf",
    "particles/items2_fx/ward_spawn_generic.vpcf",
    "particles/units/heroes/hero_broodmother/broodmother_spiderlings_spawn.vpcf",
    "particles/units/heroes/hero_skeletonking/skeletonking_hellfireblast.vpcf",
    "particles/ancient_apparition_cold_feet_frozen.vpcf",
    "particles/units/heroes/hero_sandking/sandking_caustic_finale_explode.vpcf",
    "particles/venomancer_noxious_plague_slow.vpcf",
    "particles/venomancer_noxious_contagion_buff.vpcf",
    "particles/units/heroes/hero_crystalmaiden/maiden_frostbite_buff.vpcf",
    "particles/shadow_demon_demonic_purge.vpcf",
    "particles/econ/events/plus/high_five/high_five_lvl1_overhead.vpcf",
    "particles/econ/events/plus/high_five/high_five_lvl1_travel.vpcf",
    "particles/econ/events/compendium_2023/compendium_2023_teleport_lvl2.vpcf",
    "particles/econ/events/compendium_2023/compendium_2023_teleport_lvl2_end.vpcf",
    "particles/econ/events/compendium_2024/compendium_2024_teleport_lvl3.vpcf",
    "particles/econ/events/compendium_2024/compendium_2024_teleport_lvl3_end.vpcf",

    "particles/econ/events/spring_2021/teleport_start_spring_2021_lvl3.vpcf",
    "particles/econ/events/spring_2021/teleport_end_spring_2021_lvl3.vpcf",
    "particles/econ/events/ti10/teleport/teleport_start_ti10_lvl2.vpcf", 
    "particles/econ/events/ti10/teleport/teleport_end_ti10_lvl2.vpcf",
    "particles/econ/events/ti6/teleport_start_ti6_lvl3.vpcf",
    "particles/econ/events/ti6/teleport_end_ti6_lvl3.vpcf",
    "particles/econ/events/ti7/teleport_start_ti7_lvl3.vpcf",
    "particles/econ/events/ti7/teleport_end_ti7_lvl3.vpcf",
    "particles/econ/events/ti8/teleport_start_ti8_lvl3.vpcf",
    "particles/econ/events/ti8/teleport_end_ti8_lvl3.vpcf",
    "particles/econ/events/fall_major_2016/teleport_start_fm06_lvl2.vpcf",
    "particles/econ/events/fall_major_2016/teleport_end_fm06_lvl2.vpcf",
    
 
 
 
  
    "particles/units/heroes/hero_juggernaut/juggernaut_blade_fury.vpcf",
    "particles/units/heroes/hero_juggernaut/juggernaut_blade_fury_end.vpcf",
    "particles/units/heroes/hero_juggernaut/juggernaut_omni_slash_trail.vpcf",
    "particles/units/heroes/hero_juggernaut/jugg_sword_trail.vpcf",
    "particles/units/heroes/hero_juggernaut/juggernaut_omni_slash_tgt.vpcf",
    "particles/units/heroes/hero_juggernaut/juggernaut_omni_slash_tgt_end.vpcf",



    "particles/overhead_particle/leaders/leader_overhead_artifact.vpcf",
    "particles/overhead_particle/leaders/leader_overhead_celestial.vpcf",
    "particles/overhead_particle/leaders/leader_overhead_crest.vpcf",
    "particles/overhead_particle/leaders/leader_overhead_dragon.vpcf",
    "particles/overhead_particle/leaders/leader_overhead_epic.vpcf",
    "particles/overhead_particle/leaders/leader_overhead_features.vpcf",
    "particles/overhead_particle/leaders/leader_overhead_golden.vpcf",
    "particles/overhead_particle/leaders/leader_overhead_winged.vpcf",
}


local sounds = 
{
    "soundevents/game_sounds_heroes/game_sounds_legion_commander.vsndevts",
    "soundevents/game_sounds_heroes/game_sounds_abyssal_underlord.vsndevts",
    "soundevents/game_sounds_heroes/game_sounds_antimage.vsndevts",
    "soundevents/game_sounds_heroes/game_sounds_wisp.vsndevts",
    "soundevents/game_sounds_custom_announcer.vsndevts",
    "soundevents/voscripts/game_sounds_vo_warlock_golem.vsndevts",
    
}

local models = {
    "models/courier/baby_rosh/babyroshan.vmdl",
    "models/courier/baby_rosh/babyroshan_ti10_dire.vmdl",
    "models/creeps/lane_creeps/creep_bad_ranged/lane_dire_ranged.vmdl",
    "models/creeps/lane_creeps/creep_radiant_ranged/radiant_ranged.vmdl",
    "models/creeps/lane_creeps/creep_radiant_melee/radiant_melee.vmdl",
    "models/creeps/lane_creeps/creep_bad_melee/creep_bad_melee.vmdl",
    "models/creeps/neutral_creeps/n_creep_satyr_b/n_creep_satyr_b.vmdl",
    "models/creeps/neutral_creeps/n_creep_black_drake/n_creep_black_drake.vmdl",
    "models/creeps/pine_cone/pine_cone.vmdl",
    "models/creeps/neutral_creeps/n_creep_golem_a/neutral_creep_golem_a.vmdl",
    "models/creeps/neutral_creeps/n_creep_satyr_c/n_creep_satyr_c.vmdl",
    "models/creeps/neutral_creeps/n_creep_black_dragon/n_creep_black_dragon.vmdl",
    "models/creeps/neutral_creeps/n_creep_harpy_a/n_creep_harpy_a.vmdl",
    "models/creeps/neutral_creeps/n_creep_troll_dark_a/n_creep_troll_dark_a.vmdl",
    "models/creeps/neutral_creeps/n_creep_kobold/kobold_c/n_creep_kobold_c.vmdl",
    "models/creeps/neutral_creeps/n_creep_thunder_lizard/n_creep_thunder_lizard_small.vmdl",
    "models/creeps/neutral_creeps/n_creep_harpy_b/n_creep_harpy_b.vmdl",
    "models/creeps/neutral_creeps/n_creep_centaur_lrg/n_creep_centaur_lrg.vmdl",
    "models/creeps/neutral_creeps/n_creep_centaur_med/n_creep_centaur_med.vmdl",
    "models/creeps/neutral_creeps/n_creep_ghost_a/n_creep_ghost_a.vmdl",
    "models/creeps/neutral_creeps/n_creep_worg_small/n_creep_worg_small.vmdl",
    "models/creeps/neutral_creeps/n_creep_worg_large/n_creep_worg_large.vmdl",
    "models/creeps/ice_biome/frostbitten/n_creep_frostbitten_swollen01.vmdl",
    "models/creeps/ice_biome/giant/ice_giant01.vmdl",
    "models/creeps/neutral_creeps/n_creep_satyr_a/n_creep_satyr_a.vmdl",
    "models/creeps/lane_creeps/creep_radiant_melee/radiant_melee.vmdl",
    "models/creeps/lane_creeps/creep_bad_melee/creep_bad_melee.vmdl",
    "models/creeps/lane_creeps/creep_radiant_ranged/radiant_ranged.vmdl",
    "models/creeps/lane_creeps/creep_radiant_melee/radiant_flagbearer.vmdl",
    "models/creeps/lane_creeps/creep_bad_melee/creep_bad_flagbearer.vmdl",
    "models/creeps/neutral_creeps/n_creep_troll_dark_b/n_creep_troll_dark_b.vmdl",
    "models/creeps/neutral_creeps/n_creep_thunder_lizard/n_creep_thunder_lizard_big.vmdl",
    "models/creeps/neutral_creeps/n_creep_kobold/kobold_b/n_creep_kobold_b.vmdl",
    "models/creeps/neutral_creeps/n_creep_centaur_lrg/n_creep_centaur_lrg.vmdl",
    "models/creeps/neutral_creeps/n_creep_forest_trolls/n_creep_forest_troll_berserker.vmdl",
    "models/creeps/neutral_creeps/n_creep_gnoll/n_creep_gnoll.vmdl",
    "models/creeps/neutral_creeps/n_creep_golem_b/n_creep_golem_b.vmdl",
    "models/creeps/neutral_creeps/n_creep_vulture_b/n_creep_vulture_b.vmdl",
    "models/creeps/neutral_creeps/n_creep_kobold/kobold_a/n_creep_kobold_a.vmdl",
    "models/creeps/lane_creeps/creep_bad_siege/creep_bad_siege.vmdl",
    "models/creeps/lane_creeps/creep_good_siege/creep_good_siege.vmdl",
    "models/courier/gold_mega_greevil/gold_mega_greevil.vmdl",
    "models/courier/greevil/gold_greevil.vmdl", 
    "models/courier/minipudge/minipudge.vmdl",
    "models/courier/sw_donkey/sw_donkey.vmdl",
    "models/items/courier/courier_ti10_radiant/courier_ti10_radiant_lvl1/courier_ti10_radiant_lvl1.vmdl",
    "models/items/courier/duskie/duskie.vmdl",
    "models/items/courier/faceless_rex/faceless_rex.vmdl",
    "models/items/courier/hamster_courier/hamster_courier_lv7.vmdl",
    "models/items/courier/nilbog/nilbog.vmdl",
}

local function PrecacheEverythingFromTable( context, kvtable)
    for key, value in pairs(kvtable) do
        if type(value) == "table" then
            if not string.find(key, "npc_precache_") then
               PrecacheEverythingFromTable( context, value )
            end
        else
            if string.find(value, "vpcf") then
                PrecacheResource( "particle", value, context)
            end
            if string.find(value, "vmdl") then
                PrecacheResource( "model", value, context)
            end
            if string.find(value, "vsndevts") then            
                PrecacheResource( "soundfile", value, context)
            end
        end
    end
end

function PrecacheEverythingFromKV( context )
    local kv_files = 
    {
        "scripts/npc/npc_units_custom.txt",
        "scripts/npc/npc_items_custom.txt",
    }
    for _, kv in pairs(kv_files) do
        local kvs = LoadKeyValues(kv)
        if kvs then
            PrecacheEverythingFromTable( context, kvs)
        end
    end
end

return function(context)
    PrecacheEverythingFromKV(context)
    PrecacheEverythingFromTable( context, models )
    for _, p in pairs(particles) do
        PrecacheResource("particle", p, context)
    end
    for _, p in pairs(sounds) do
        PrecacheResource("soundfile", p, context)
    end
    PrecacheResource( "particle_folder", "particles/neutral_fx/", context )
    PrecacheResource( "particle_folder", "particles/items_fx/", context )
    PrecacheResource( "particle_folder", "particles/items5_fx/", context )
    PrecacheResource( "particle_folder", "particles/items4_fx/", context )
    PrecacheResource( "particle_folder", "particles/items3_fx/", context )
    PrecacheResource( "particle_folder", "particles/items2_fx/", context )
    local heroes = LoadKeyValues("scripts/npc/dota_heroes.txt")
    for k,v in pairs(heroes) do
        PrecacheResource( "soundfile", "soundevents/game_sounds_heroes/game_sounds_" .. k:gsub("npc_dota_hero_","") ..".vsndevts", context )  
        PrecacheResource( "soundfile", "soundevents/voscripts/game_sounds_vo_" .. k:gsub("npc_dota_hero_","") ..".vsndevts", context ) 
    end
end



